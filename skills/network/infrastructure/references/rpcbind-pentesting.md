# RPCBind/Portmapper Pentesting Skill

## Goal

Enumerate RPC services via RPCBind/Portmapper on port 111 to discover additional attack vectors.

## Port

- **111** - RPCBind/Portmapper (TCP/UDP)

## Methodology

1. **Identify RPCBind:** Scan for port 111
2. **Enumerate RPC Services:** List registered programs
3. **Identify Service Ports:** Map RPC programs to ports
4. **Attack Exposed Services:** Target vulnerable RPC services
5. **Exploit Weaknesses:** Leverage NFS, NIS, or other RPC services

## Enumeration

```bash
# Nmap scan
nmap -sV -p 111 <target>
nmap -sU -p 111 <target>  # UDP

# RPC service enumeration
nmap -p 111 --script rpcinfo <target>
```

## Listing RPC Services

```bash
# Using rpcinfo
rpcinfo -p <target>

# Output columns: program vers proto port service
# Example:
# 100000    2   tcp    111  portmapper
# 100000    2   udp    111  portmapper
# 100003    3   tcp   2049  nfs
# 100005    1   tcp  43831  mountd
```

## Common RPC Programs

| Program Number | Service | Notes |
|----------------|---------|-------|
| 100000 | portmapper | RPC port mapping |
| 100003 | nfs | Network File System |
| 100005 | mountd | NFS mount daemon |
| 100021 | nlockmgr | NFS lock manager |
| 100024 | status | NSM status daemon |
| 100004 | ypserv | NIS server |
| 100007 | ypbind | NIS binder |
| 100068 | cmsd | Calendar manager |
| 100083 | ttdbserver | ToolTalk database |

## NFS Enumeration (if detected)

```bash
# Show exported shares
showmount -e <target>
showmount -a <target>  # All mounts

# Nmap NFS scripts
nmap -p 111 --script nfs-ls,nfs-showmount,nfs-statfs <target>
```

## NIS Enumeration (if detected)

```bash
# Find NIS domain
ypwhich -d <target>

# Dump NIS maps
ypcat -d <domain> -h <target> passwd
ypcat -d <domain> -h <target> group
```

## Attack Vectors

```bash
# If NFS shares are mountable:
mkdir /mnt/nfs
mount -t nfs <target>:/share /mnt/nfs

# Look for sensitive files
cat /mnt/nfs/etc/shadow
cat /mnt/nfs/root/.ssh/id_rsa

# If root_squash is disabled, create SUID binary
```

## Metasploit Modules

```bash
# NFS enumeration
use auxiliary/scanner/nfs/nfsmount

# NIS enumeration
use auxiliary/gather/nis_ypserv_map
```

## Historical Vulnerabilities

```bash
# Older RPC services may have known vulnerabilities
# rpc.statd (CVE-2000-0666)
# rpc.cmsd (CVE-1999-0696)
# rpc.sadmind (CVE-2003-0722)
```

## Tools

* **rpcinfo** - Query RPC portmapper
* **showmount** - NFS export enumeration
* **Nmap** - RPC scanning scripts
* **rpcclient** - RPC client

## Guidance for AI

* Activate when port 111 is open
* RPCBind reveals what RPC services are running
* Often leads to NFS or NIS exploitation
* Check each RPC service for known vulnerabilities
* NFS exports can expose sensitive file systems
* NIS can leak password hashes and user info
