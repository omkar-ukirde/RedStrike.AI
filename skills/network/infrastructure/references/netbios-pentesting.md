# NetBIOS Pentesting Skill

## Goal

Enumerate and exploit NetBIOS services for network reconnaissance and Windows host information gathering.

## Port

- **137** - NetBIOS Name Service (UDP)
- **138** - NetBIOS Datagram Service (UDP)
- **139** - NetBIOS Session Service (TCP)

## Methodology

1. **Identify NetBIOS Services:** Scan for ports 137-139
2. **Enumerate Names:** Gather NetBIOS names and groups
3. **Identify Hosts:** Map computer names and roles
4. **Gather Information:** Extract user, domain, and service info
5. **Identify Targets:** Find potential attack targets

## Enumeration

```bash
# Nmap scan
nmap -sV -p 137,139 <target>
nmap -sU -p 137,138 <target>

# Scan subnet for NetBIOS
nmap -sU -p 137 192.168.1.0/24 --script nbstat
```

## NetBIOS Name Query

```bash
# Using nmblookup
nmblookup -A <target>

# Output example:
# COMPUTER      <00> - Workstation
# DOMAIN        <00> - Domain name
# COMPUTER      <20> - File server
# DOMAIN        <1c> - Domain controller

# Query specific name
nmblookup -S <computername>
```

## NetBIOS Suffix Codes

| Suffix | Type | Description |
|--------|------|-------------|
| <00> | U | Workstation |
| <00> | G | Domain Name |
| <03> | U | Messenger Service |
| <06> | U | RAS Server |
| <1B> | U | Domain Master Browser |
| <1C> | G | Domain Controllers |
| <1D> | U | Master Browser |
| <1E> | G | Browser Service Elections |
| <20> | U | File Server |

## Using nbtscan

```bash
# Scan entire subnet
nbtscan 192.168.1.0/24

# Verbose output
nbtscan -v 192.168.1.0/24

# Output format:
# IP             NetBIOS Name     Server    User
# 192.168.1.10   COMPUTER         <server>  <user>
```

## Nmap NSE Scripts

```bash
# NetBIOS enumeration
nmap -sU -p 137 --script nbstat <target>

# Output includes:
# - NetBIOS name
# - MAC address
# - User logged in
```

## Information Gathering

```bash
# Get MAC address
nmblookup -A <target> | grep "MAC"

# Identify Domain Controllers
nmblookup -M <domain>

# Find Master Browser
nmblookup -M -- -
```

## Enum4linux

```bash
# Comprehensive enumeration
enum4linux -a <target>

# NetBIOS specific
enum4linux -n <target>
```

## Null Session Attack

```bash
# Connect with null session
net use \\<target>\IPC$ "" /u:""

# Then enumerate
net view \\<target>
net user /domain
```

## Tools

* **nmblookup** - NetBIOS name lookup
* **nbtscan** - Network scanner
* **enum4linux** - Comprehensive Windows/Samba enumeration
* **Nmap** - NSE scripts

## Guidance for AI

* Activate when ports 137-139 are open
* NetBIOS reveals computer names and roles
* Suffix codes indicate service types
* Often found alongside SMB (port 445)
* Null sessions may allow unauthenticated enumeration
* Search for domain controllers (<1C>) for further attacks
