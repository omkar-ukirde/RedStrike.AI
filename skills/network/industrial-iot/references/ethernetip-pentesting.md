# EtherNet/IP Pentesting Skill

## Goal

Identify and exploit vulnerabilities in EtherNet/IP industrial control networks.

## Ports

- **44818** - EtherNet/IP (TCP/UDP)
- **2222** - EtherNet/IP (TCP/UDP, alternate)

## Methodology

1. **Identify Devices:** Scan for EtherNet/IP ports
2. **Enumerate Devices:** Query device identity and capabilities
3. **Read Data:** Access tag/variable values
4. **Write Data:** Modify controller values if permitted
5. **Map Network:** Understand industrial control topology

## Enumeration

```bash
# Nmap scan
nmap -sV -p 44818,2222 <target>

# EtherNet/IP identity query
nmap -p 44818 --script enip-info <target>
```

## Device Discovery

```bash
# Using enip-info script
# Returns:
# - Vendor ID
# - Device Type
# - Product Code
# - Revision
# - Serial Number
# - Product Name
```

## CIP (Common Industrial Protocol) Objects

| Class ID | Object |
|----------|--------|
| 0x01 | Identity |
| 0x02 | Message Router |
| 0x04 | Assembly |
| 0x06 | Connection Manager |
| 0x64 | Symbol |
| 0xAC | Program |
| 0xB2 | Tag |

## Reading Tags

```python
# Using pycomm3 (Allen-Bradley)
from pycomm3 import LogixDriver

with LogixDriver('<target>') as plc:
    # Read single tag
    result = plc.read('Tag1')
    print(result.value)
    
    # Read multiple tags
    result = plc.read('Tag1', 'Tag2', 'Tag3')
    for tag in result:
        print(f"{tag.tag}: {tag.value}")
```

## Writing Tags

```python
# Write to tag (DANGEROUS - affects physical processes)
with LogixDriver('<target>') as plc:
    # Write single tag
    plc.write('Tag1', 100)
    
    # Write multiple
    plc.write(('Tag1', 100), ('Tag2', 200))
```

## Tag Enumeration

```python
# Get all tags
with LogixDriver('<target>') as plc:
    tags = plc.get_tag_list()
    for tag in tags:
        print(f"{tag['tag_name']}: {tag['data_type']}")
```

## Program Enumeration

```python
# List programs
with LogixDriver('<target>') as plc:
    programs = plc.get_program_tag_list('MainProgram')
    for p in programs:
        print(p)
```

## Attack Scenarios

```bash
# Stop/Start PLC
- Access run/program mode switches
- Change controller key position

# Process Manipulation
- Modify setpoints
- Change motor speeds
- Disable safety interlocks

# Information Disclosure
- Read proprietary tag values
- Extract program logic
```

## Metasploit Modules

```bash
# EtherNet/IP enumeration
use auxiliary/scanner/scada/enip_info

# CIP discovery
use auxiliary/scanner/cip_enumerate
```

## Tools

* **pycomm3** - Python library for Rockwell/Allen-Bradley
* **Nmap** - enip-info script
* **cpppo** - EtherNet/IP library
* **Metasploit** - ICS modules

## Guidance for AI

* Activate when port 44818 is open
* EtherNet/IP is common in manufacturing/process control
* Allen-Bradley/Rockwell PLCs are primary users
* Tag read/write can directly affect physical processes
* Exercise extreme caution with write operations
* Real-time systems - disruption can cause physical harm
