# Telnet Pentesting Skill

## Goal

Exploit Telnet services to gain remote command-line access to systems.

## Methodology

1. **Discovery**: Identify Telnet services
2. **Banner Grabbing**: Extract service and OS information
3. **Credential Attacks**: Brute-force or use default credentials
4. **Sniffing**: Capture plaintext credentials from network traffic
5. **Post-Exploitation**: Leverage shell access

## Port

- 23/TCP: Telnet

## Tools

* **telnet**: Telnet client
* **nmap**: Telnet scripts
* **hydra**: Password brute-forcing
* **Wireshark**: Traffic capture

## Example Commands

```bash
# Banner grabbing
telnet target 23
nc target 23

# Nmap Telnet enumeration  
nmap -p23 --script telnet-* target
nmap -p23 --script telnet-brute target
nmap -p23 --script telnet-encryption target
nmap -p23 --script telnet-ntlm-info target

# Brute-force credentials
hydra -l admin -P /usr/share/wordlists/rockyou.txt telnet://target
medusa -h target -u admin -P wordlist.txt -M telnet
ncrack -p23 --user admin -P wordlist.txt target
```

## Credential Sniffing

```bash
# Telnet sends everything in plaintext!

# Capture with tcpdump
tcpdump -i eth0 -nn -A -s0 'port 23'

# Capture with Wireshark
# Filter: telnet

# Extract credentials from pcap
tcpdump -r capture.pcap -A 'port 23' | grep -i "login\|password"

# MITM attack to intercept credentials
# See arp_spoofing.md for MITM setup
```

## Default Credentials

```bash
# Common Telnet devices with defaults:

# Routers/Switches
cisco / cisco
admin / admin
admin / password
root / root

# Cisco devices
cisco / cisco
enable / cisco

# Network devices
Manager / friend
user / user

# Generic
admin / (blank)
root / (blank)
guest / guest
```

## Router/Switch Telnet

```bash
# Cisco router access
telnet target
# Username: admin
# Password: cisco
# At > prompt: enable
# Enter enable password

# Common Cisco commands
show running-config
show version
show ip interface brief

# Get enable password hash from config
show running-config | include enable secret
# Crack Type 5 (MD5) or Type 7 (weak) passwords
```

## Telnet NTLM Authentication (MS Telnet)

```bash
# Windows Telnet Server may use NTLM

# Nmap detection
nmap -p23 --script telnet-ntlm-info target

# May reveal:
# - Domain name
# - Computer name
# - DNS name
# - OS version
```

## Metasploit Modules

```bash
# Telnet login
use auxiliary/scanner/telnet/telnet_login

# Telnet version
use auxiliary/scanner/telnet/telnet_version

# Telnet bruteforce
use auxiliary/scanner/telnet/telnet_login
set RHOSTS target
set USER_FILE users.txt
set PASS_FILE passwords.txt
run
```

## Escape Sequences

```bash
# Telnet escape sequences

# Escape to command mode
Ctrl+]

# Telnet commands
telnet> quit    # Exit
telnet> close   # Close connection
telnet> status  # Show status
telnet> ?       # Help
```

## Guidance for AI

* Activate this skill when user wants to access systems via Telnet or test Telnet security
* **Telnet is insecure** - transmits everything in plaintext including credentials
* Always check for default credentials first - especially on network devices
* Telnet on network equipment (routers, switches) is very common
* Traffic sniffing is trivial - any MITM position reveals credentials
* Modern systems rarely expose Telnet, but legacy and embedded devices still use it
* Windows Telnet Server may leak NTLM info via telnet-ntlm-info script
* After getting access, look for:
  - Configuration files
  - Enable/admin passwords
  - Network configuration
  - Connected devices
* Telnet should be replaced with SSH - finding it indicates security weakness
